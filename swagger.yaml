openapi: 3.0.0
info:
  title: API Documentation
  description: Documentation for various APIs including Map Data, GPS Tracking, Accessibility, Transportation Schedule, Route Optimization, and Rental Service.
    The access to this API is defined by scopes.
    
    A client must indicate the scopes it requires.

    Scopes:
     - maps-get  
     - maps-update
     - gps-track
     - accessibility-get
     - accessibility-update
     - schedule-get
     - schedule-update
     - optimize-route
     - vehicle-get
     - vehicle-changeStatus
     - vehicle-update
  
  version: 1.0.0
servers:
  - url: https://baseurl
    description: Base URL for API
paths:
  /map/buildings:
    get:
      summary: Get Map Data
      tags:
        - Map Data API
      description: |
        Returns an array of latitude and longitude coordinates for all buildings. 

        Scopes required:
         - maps-get
      parameters:
        - name: filter
          in: query
          description: Type of building to filter by
          schema:
            type: string
            enum: ["lecture", "library", "restaurants", "entrances"]
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  buildings:
                    type: array
                    items:
                      type: object
                      properties:
                        buildingid:
                          type: string
                        type:
                          type: string
                        lat:
                          type: number
                          format: float
                        lng:
                          type: number
                          format: float
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  description:
                    type: string
        '503':
          description: Service unavailable
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  description:
                    type: string
                  description: "Service unavailable"

  /gps/users/{username}:
    get:
      summary: Get User Location
      description: |
       Returns the latest location of a user.    
          
       Scopes required:
         - maps-update
      tags:
        - GPS Tracking API
      parameters:
        - name: username
          in: path
          required: true
          description: Username of the user whose location is being requested
          schema:
            type: string
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  data:
                    type: object
                    properties:
                      username:
                        type: string
                      latest_location:
                        type: object
                        properties:
                          lat:
                            type: number
                            format: float
                          lng:
                            type: number
                            format: float
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  description:
                    type: string
        '503':
          description: Service unavailable
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  description:
                    type: string

  /gps/vehicle/{vehicleid}:
    get:
      summary: Get Vehicle Location
      tags:
        - GPS Tracking API
      description: Returns the latest location of a vehicle.
      parameters:
        - name: vehicleid
          in: path
          required: true
          description: Vehicle ID of the vehicle whose location is being requested
          schema:
            type: string
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  data:
                    type: object
                    properties:
                      vehicle_id:
                        type: string
                      current_location:
                        type: object
                        properties:
                          lat:
                            type: number
                            format: float
                          lng:
                            type: number
                            format: float
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  description:
                    type: string

  /gps/vehicles:
    get:
      summary: Get All Vehicles
      tags:
        - GPS Tracking API
      description: Returns a list of all vehicles with their current locations.
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  data:
                    type: object
                    properties:
                      vehicles:
                        type: array
                        items:
                          type: object
                          properties:
                            vehicle_id:
                              type: string
                            type:
                              type: string
                            current_location:
                              type: object
                              properties:
                                lat:
                                  type: number
                                  format: float
                                lng:
                                  type: number
                                  format: float
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  description:
                    type: string
        '503':
          description: Service unavailable
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  description:
                    type: string

  /entrances/wheelchair:
    get:
      summary: Get Wheelchair Accessible Entrances
      tags:
        - Accessibility API
      description: Returns locations of wheelchair-accessible entry points.
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  data:
                    type: object
                    properties:
                      entrances:
                        type: array
                        items:
                          type: object
                          properties:
                            lat:
                              type: number
                              format: float
                            lng:
                              type: number
                              format: float
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  description:
                    type: string
        '503':
          description: Service unavailable
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  description:
                    type: string
  /bus/schedules:
    get:
      summary: Retrieve bus schedule
      tags:
        - Transportation Schedule API
      parameters:
        - name: date
          in: query
          required: true
          schema:
            type: string
            format: date
            example: "2024-08-16"
      responses:
        '200':
          description: Successfully retrieved schedule
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      date:
                        type: string
                        format: date
                      schedules:
                        type: array
                        items:
                          type: object
                          properties:
                            bus_id:
                              type: string
                            departure_time:
                              type: string
                              format: time
                            arrival_time:
                              type: string
                              format: time
                            from:
                              type: string
                            to:
                              type: string
                            status:
                              type: string
                              enum: [On Time, Delayed, Cancelled]
                example:
                  status: "success"
                  data:
                    date: "2024-08-16"
                    schedules:
                      - bus_id: "A123"
                        departure_time: "08:00"
                        arrival_time: "08:45"
                        from: "Wits Main Campus"
                        to: "Wits Education Campus"
                        status: "On Time"
                      - bus_id: "A124"
                        departure_time: "09:00"
                        arrival_time: "09:45"
                        from: "Wits Education Campus"
                        to: "Ernest Openheimer Halls of Residence"
                        status: "Delayed"
                      - bus_id: "A125"
                        departure_time: "10:00"
                        arrival_time: "10:45"
                        from: "Ernest Openheimer Halls of Residence"
                        to: "Wits Medical Campus"
                        status: "Cancelled"
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                    example: 400
                  description:
                    type: string
                    example: "Invalid request"
        '503':
          description: Service unavailable
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                    example: 503
                  description:
                    type: string
                    example: "Service unavailable"

  /route/optimize:
    post:
      summary: Optimize Route
      tags:
        - Route Optimization API
      description: Calculates the most efficient route between multiple points.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                points:
                  type: array
                  items:
                    type: object
                    properties:
                      lat:
                        type: number
                        format: float
                      lng:
                        type: number
                        format: float
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  data:
                    type: object
                    properties:
                      optimized_route:
                        type: array
                        items:
                          type: object
                          properties:
                            lat:
                              type: number
                              format: float
                            lng:
                              type: number
                              format: float
        '400':
          description: Bad/invalid request
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string
        '503':
          description: Service unavailable
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string
                    
  /rentals/vehicles:
    get:
      summary: Returns all vehicles
      tags:
        - Rental Service API
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  vehicles:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        type:
                          type: string
                          enum: [bike, scooter, skateboard]
                        location:
                          type: string
                        available:
                          type: boolean
              example:
                vehicles:
                  - id: "B1"
                    type: "bike"
                    location: "station1"
                    available: true
                  - id: "S1"
                    type: "scooter"
                    location: "station2"
                    available: false
                  - id: "SB1"
                    type: "skateboard"
                    location: "station3"
                    available: true

  /rentals/vehicles/{vehicle_id}:
    parameters:
      - name: vehicle_id
        in: path
        required: true
        schema:
          type: string

    get:
      summary: Returns one vehicle
      tags:
        - Rental Service API
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  type:
                    type: string
                    enum: [bike, scooter, skateboard]
                  location:
                    type: string
                  available:
                    type: boolean
              example:
                id: "B1"
                type: "bike"
                location: "station1"
                available: true
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string
              example:
                status: 400
                message: "Please provide vehicle_id"
        '404':
          description: Vehicle not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string
              example:
                status: 404
                message: "Vehicle not found"

  /rentals/locations:
    get:
      summary: Return an array of latitude and longitude of the rental service locations
      tags:
        - Rental Service API
      responses:
        '200':
          description: Operation was successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  rental_locations:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        lat:
                          type: number
                          format: float
                        lng:
                          type: number
                          format: float
              example:
                rental_locations:
                  - id: "station1"
                    lat: 20.008921
                    lng: 21.01231
                  - id: "station2"
                    lat: 20.008921
                    lng: 21.01231

  /rentals/locations/{id}:
    get:
      summary: Return data of a specific rental service location
      tags:
        - Rental Service API
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Operation was successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  lat:
                    type: number
                    format: float
                  lng:
                    type: number
                    format: float
              example:
                id: "station1"
                lat: 20.008921
                lng: 21.01231
        '404':
          description: Rental station not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                  message:
                    type: string
              example:
                status: 404
                message: "Rental station not found"


components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
    apiKeyAuth:
      type: apiKey
      in: header
      name: Authorization

securitySchemes: 
  - bearerAuth: []
  - apiKeyAuth: []

